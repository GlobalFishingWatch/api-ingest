var crypto = require('crypto');
var path = require('path');
var fs = require('fs');

const PRIVATE_KEY =
  'LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlHNUFJQkFBS0NBWUVBb1ptRW1TVEx2ajNUNm96RFlvVjAvVGdrV0doa2l6OUNQc3ZBMDQwZkNEc01MbytxCkNvL00vZWxDTmlVL2c0RmVJbEZ6SkMzbkxQVTlUcFFZQWd1bWJPZmYzV2VyaVU4VHRwTlc0SXVBVzJRUWg4K0cKNHFCTlM4QzNjbjhBcno0L1RSQUY4d1N3ekVjaUdHLytqZUhjbVo5OUtyVmo1UVBYL2F5SURzVFU3SW1sMmZDZwpsRE8vMGc0NTMvY2EzaE9MZFpWdE9LeW9nV2g3U3dOMEJCek1Ga2dINmFNTW9Wd1QxWU5aZ0FmeVp3MHNnd1BPCkJqRGlkK2g0WHVIazc0Z2dxZENYRjc1djBKYXpwTHNUeFg5MzJtZnppVStvcDhlQlVrYVB2MUpRS21weUxOR0wKWGxIdy80dkcxTEUrVWVRdEppU2ZzWEJ3MDJidGYrSHAraVVhT1Q0MzVQMjMwcDJBZ1J6TUlTMXM4Q01VUzJaNwpIZ2VyWUE5TzZuT0Z2RkMzMFUvVWhUdmEvcmkvbDcxcGpiNElIdStveEltYVE4VWU0NUJmeFUvL2ZwRXQyQ1RsClZ6TkkrazRRSG9DZnFJa2JrOFN6NnE4ODdwa0FsVDJxVGFVNVByUzk0NUFSVHN6WHV4ZThNeTRyc2MxSTYxOWgKTnNybXNBMEJHeHpvcVZ2dEFnTUJBQUVDZ2dHQVF5cFNnWEJZdW1acU9QZHVrZmxVS1piM0RFTy9YbHpaaE00ZApCQkNJa0Z3eWNQdkhPZ0tRdWd3RU9BcjlQZ1E4QXRtRm1NajNaNms2WlBtS2pQY1lvZlV5QjR6NkwrVE5GYnBoCmhveVV1ZWQ2TTJoZThMeWR3OW1DcGJVQnJOU2JiTVUzSTgyVVNpTmFtWHVhK28rZ3A3MHhRZG9JZmZ3OS9yS0MKRGxsakFqa24xTkI5Zlh1UXc1YWtHV0ZVS205SExJVUIwMmQzMWVsK0xTeHZRUEpUSlFPbFBrZEZqWjkrb3VTbwpBMTNLTTJpM1VuRDNaWDFWODI2TThTckVnNFk1SENHcGJOeFpOcnJOOG9vdUJodlI4ODZUVytmVVlMVW5DbEFRCjBMTnVVTnArRjJnaVVsRGd4V0NDSTZGUlZRSkdIZG52NE1BVVIrQzR4TDFienJzVCtML0VIRjAwZGFENWhUc0cKK3F4UGpTaWFwSzF0Z2ZpaVVuZmgxOWUwTEFFSVFDRWo2WXhDakw0K0IyMmhSSmMrNVBzeDVmMDFHQkNqVUQ3MwpoV0Z2MiszWVVoNGc5MXREdktNZmVORVg2b3JkbUZHTVJFOEVuNk1KK2YwN3o4YS9Ec3lIa0MwZ2NTUms0RHQvCkl0UlZlK2gzaUxtR0tTcVAwbTdqZjZ4Z0ViQ2hBb0hCQU03MGdubERibG9xTVczbWptU0JPOTNrZWxmMnNHZ3IKcjZ4ZVRETFZEUmJRdnhqc3NGdXdVM291MFdpNjU2UG5LRm1mTWViQ1J0RDNhWk5jcUlIWWdQTlBTR0xBa0JKRwoyNUtRUnJHT1NvQmxjcmNKSXpSc2NlamxiZzFpYUM5bnZ1T3ROaENUN3Z0S2lGaVJ4RVBhUHFYRVlNSWp2Q0doCjhZNWlIdWxKL3FpdXNFa3BHMDVrVEt4cG4vdlc4Y3A4RWN4OFpqaFQyMU5RaTZkR20weUwrTFFJSHlrNWRHMmEKVkE4ZGVMdGY0Wld4ZHl5TDVpM0pEN0t1cXZFdVBZQUpPUUtCd1FESDVXWCtjdFFZcUM1eHFZbU84OE9aQ1lBMwoyWEVSWFRXOFNKckIrUC91dVNwZkF5cmtPZGtWdkt6bk9kWmowaDFId0VZcjVZbmM4aUJ0NVd4YzVSYTVJWEY4CllYczRGbDR5eU9UVTIzWEVSdUs1ME81azZScjNrZ3ZNS2VFNXZoK0k4RE9TWm1DWllkY2ttR2ZQOWdGM1dFOUQKVzU5dlR5MGk3MDVKVHFHSWpJcHZQY1lYaXZxSnpzaUpTV3lsak90ZmpWdE1JUXYybE1pdGJNL0lLdjlsbzdkcApHamtXQzZJcDBUTHU3eUl4WjlqcUhUT3RTRkZUeWRxSWpqS1VyRlVDZ2NFQXNGc09BQlhsS0xLQjBweEF4UWFYCnBIdTVnZEgyKzU0V29uVHN5L2hmb2d5YWU3dmVnUk9kM3lXY1Qzbk9RUTZQaE9leTEyakFmZndIbklxK0VZQVUKU3NKSjlkVVFNSEx2VTFMYzJ4dGRBMUx2MFdmWTl5aGVYVTk5VzZ4N0NjS0htVzZWL3NTQlJ1UjVrYmdObnFDUQorQ09ETEl6VkdYZnQ1eDVZSndabUd3cFpzTTUxdFhTbEhkc1llTHZ1NlZTV3VrRmJ2aTQvWFJ6ckZNMkhNMUNuCnk0cU1PMDM1bUJpRi95ZG5KWTBNSjhyRnVsRXhBZDB2SWwzVHo1aE8waGVKQW9IQUZZWlZLa1lSSXFxUmZibkUKenpqZWVnODAyRTY0eHlialQyZitDaDhXNkF6V1RDN2FJb004SmdRUUZrSDdIUHFXSHBETXZaTlUrZzYwZ1VEdwpIenluNnIxNEsrMlBTQ1hZZE4xL0RwQ25LTUI5VDRiNDlMTEpMWmx6WGNPd3RmZ01DMEhhTzh4OFlHZlJzK1laClg2SmMzQTROVXZKOXc0MmlEWjM1THhtaGVVT3c4SE9WYmhtUUN1RFNaVDRiemVQVHdKRkhJSFo2aEUzWEloMlMKYmpwN0QrWEdMVEllcllvSkp6bVlvM1BxbWFsV0NUZWx4ZVlBbytZYmV4TGN6WGVWQW9IQkFMSEZzYVdkRk9OUApBbHhsSngwT1VING5UaUYyOVowSXI5YjcrOHFMUEJWT2grajk3ZENod3Z6Q1Q3OGIrMmlycDlQTlh4RW5lT1QxCjJ3R0NwVEN3clNEU2VFZENZYmdJZ3ZRWmFHd1dlRFNlMEtJN3BCWEZlNFhZNG5RbDhJdXRDOWw0WlV3THd4VHUKUC9KdXlUTjZmNVRqOUlIamViU0pza1NXc0dNWWJvTm9EdUM2TWdmK1VIdnFad2w0RXZZbEFON0E5NnNvWWpRRgp3UDE0LytXdVd2cS9TY0pRVXIzbW1YQXB0UldBM1J0SWE4MU9MR3VZb3d6dU0vY3hUYVFTVmc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=';
const PUBLIC_KEY =
  'LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQm9qQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FZOEFNSUlCaWdLQ0FZRUFtL1h5VWZUNFhIakNIRWdlUXFVSgp6QmZnV2hlMUQ2ZWYyaEVhTDVYMitpdkoweEl2bndiU3RtZ0s3Q21YejN5djVrSXM3OS9LNGNYaDJzZFQ2Z1dxCmp0ck1OcHZwN0pmaU8xQ3ZpNmkybnBYNnM1ZTZqalBPSnQwa3VuQitONU80KytVRHh1YjhHTUhZSmFCUDByRW0Kd1c4Mlk4SmMxSjhsVm40R2lLWmQrMkpkdjVUT0xuL2p0UDRyeVVyNW9QeU1NRnZUblo1SHBFbjlQOFNUTjNvZwovc283UzZNSmNrMGdKQlRjeDN0eExqZ1hqR1NXRTV1VlVXNkMvamxEWWo5aXVWK2huNC9CcHlJYVRlVElBQ1pvCkdlUUR3S0ZydkVXY0h2cTZMZTZKRFBtZTJudWZBY2FsRXBtMmhoWmtRenhPRis2VEF0UWdiOWVsNzVsK0dMR28KZkYzVGJhTzh6ei9QVnJkb2NoYkJGVExneWhYdFhxQ1VTdW9FWkQ2Z2t5aVcvYUF4aVhzZmgrYVdRdTdKV01BWgpMYk5lVG5QdzZpRWhKNWtXRDFZUXJycVd3R1F5eVNUMTFqS3NzR1lYY3ZaRGU0MTFOM0J4T3R4UkdtdGZKblBICjdjeXBEU1FWOFhZOHJOd0xBMm84ZDdiWGxRLzh4OWpjaHR1Zlo0YkJIandsQWdNQkFBRT0KLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg==';

const publicKey = new Buffer(PUBLIC_KEY, 'base64').toString('ascii');
const privateKey = new Buffer(PRIVATE_KEY, 'base64').toString('ascii');
const encryptStringWithRsaPublicKey = function(obj) {
  const buffer = Buffer.from(JSON.stringify(obj));
  const encrypted = crypto.publicEncrypt(publicKey, buffer);
  return encrypted.toString('base64');
};

var decryptStringWithRsaPrivateKey = function(toDecrypt) {
  const buffer = Buffer.from(toDecrypt, 'base64');
  const decrypted = crypto.privateDecrypt(privateKey, buffer);
  return JSON.parse(decrypted.toString('utf8'));
};

const positions = {
  lat: 29.7845833333,
  lon: -31.9999666667,
  id: 'fb241dde-3aa0-4301-b190-05519428cf0b',
  timestamp: new Date().toISOString(),
};
const msg = encryptStringWithRsaPublicKey(positions);
console.log(msg);

// const obj = decryptStringWithRsaPrivateKey(msg);
// console.log(obj);
